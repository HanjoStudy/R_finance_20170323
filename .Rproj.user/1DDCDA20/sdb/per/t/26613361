{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Financial Econometrics\"\nInstitution: Stellenbosch University\ndate: \"Semester II 2016\"\noutput:\n  beamer_presentation:\n    fig_height: 3.5\n    fig_width: 6.5\n    incremental: yes\n    keep_tex: no\n    template: Tex/ClassSlide.tex\n  slidy_presentation:\n    incremental: no\ncolortheme: beaver\nTheme: CambridgeUS\ngraphic: Tex/US.jpg\nbibliography: Tex/ref.bib\nsubtitle: Copulas\nAuthor: Hanjo Odendaal\ntoc: yes\n---\n\n```{r, include=FALSE}\nlibrary(\"rmsfuns\")\nload_pkg(c(\"dplyr\", \"ggplot2\"))\n\n```\n\n  \n# Introduction\n\n\\section{Introduction}\n\n* In the past session, you have encountered a vast array of financial models\n    + Basic ARIMA models for the mean equation\n    + GARCH extensions to deal with heteroscedasticity\n    + Multivariate GARCH models that deal with dependence modeling\n* Theoretical problem arises when we talk about __dependence__\n    + Capturing co-movement between financial asset returns with linear correlation has been the staple approach in modern finance since the birth of Harry Markowitz's portfolio theory \n    + But linear correlation is only appropriate when the dependence structure (or joint distribution) follow a normal distribution\n* Enter copulas - flexible framework to model general multivariate dependence\n\n# References\n\n* The work on copulas are vast, as this isn't just a technique but a field of statistics\n    + Go to reference: @joe2014dependence\n    + Financial applications: @ruppert2011statistics, @carmona2014statistical\n    + Actuarial: @charpentier2014computational\n* For applications on South Africa is limited, but there are some works for emerging markets\n\n\n# Goal\n* To introduce to you an extension in the field of risk management to a multivariate space with multiple assets. \n* Grasp basic concepts and generators within the field of copulas\n    + Learn to walk, before we can run\n    + Revisit your statistics\n* Understand the field of copulas to such an extent that you might go on to do a PhD in this field ;-)\n\n# Fields where copulas are applied\n* Quantitative finance\n    * Stress-tests and robustness checks \n    * \"Downside/crisis/panic regimes\" where extreme downside events are important\n    * Pool of asset evaluation\n    * Latest development: Vine Copulas\n    * Hot research page [here](https://en.wikipedia.org/wiki/Copula_(probability_theory))\n* Civil engineering\n* Warranty data analysis\n* Turbulent combustion\n* Medicine\n\n\\section{Understanding Copulas}\n\n# Introduction to copulas\n* Copula stems from the latin verb copulare; bond or tie.\n    * Regulatory institutions are under pressure to build robust internal models to account for risk exposure\n    * Fundamental ideology of these internal models rely on joint dependency among whole basket of mixed instruments\n    * This issue can be addresed through the copula instrument\n    * It functions as a linking mechanism between uniform marginals such as the cdf\n* Copula theory was first developed by Sklar in 1959 @nelsen2007introduction.\n\n# Introduction to copulas (Sklar)\n* Sklar's theorem forms the basis for copula models as:\n    * It does not require identical marginal distributions and allows for n-dimensional expansion\n* Let $X$ be a random variable with marginal cumulative distribution function:\n    + $F_X(x) = \\mathcal{P}(X \\leq x)$\n    + Probability that random variable $X$ takes on a value less or equal to point of evaluation\n    + $F_X(x) \\sim U(0,1)$\n    \n# Introduction to copulas (Sklar cont.)\n* If we now denote the inverse CDF (Quantile funtion) as $F_x^{-1}$\n    + $U \\sim U(0,1)$ then $F_x^{-1}(U) \\sim F(X)$\n* This allows a simple way for us to simulate observations from the $F_X$ provided the inverse cdf, $F_X^{-1}$ is easy to calculate\n* Think, median is $F_X^{-1}(0.5)$\n\nLets have a look visually\n\n# Definitions and basic properties\n* Define the uniform distribution on an interval $(0,1)$ by $U(0,1)$, i.e the probability of a random variable $U$ satisfying $P(U \\leq u) = u$ for $u \\in (0,1)$\n    * This is the quantile function $(Q = F^{-1})$\nProbability transformation implies that if $X$ has a distribution function $F$, then $F(X) \\sim U(0,1)$ iff $F$ is continous\n\n\n# Definitions and basic properties (cont)\n__Definition (Copula):__ A d-dimensional copula is the distrubutiom function $\\mathcal{C}$ of a random vector $U$ whose components $U_k$ are uniformly distributed\n\\vspace{-2cm}\n  \\begin{align}\nC(u_1, \\ldots, u_d) = P(U_1 \\leq u_1, \\ldots, U_d \\leq u_d), (u_1, \\ldots, u_d) \\in (0,1)^d\n\\end{align}\n\\vspace{-1.5cm}\nThus Sklar's theorem states:\n\\vspace{-1.5cm}\n  \\begin{align}\nC(F_1(x_1), \\ldots,F_d(x_d)) &= P(U_1 \\leq F_1(x_1), \\ldots, U_d \\leq F_d(x_d))\\notag\\\\\n                             &= P(F_1^{-1}(U_1) \\leq x_1, \\ldots, F_d^{-1}(U_d) \\leq x_d)\\notag\\\\\n                             &= F(x_1, \\ldots, x_d)\n\\end{align}\n\n#Joint distribution function:\n\n* This represents the joint distribution function function $F$ can be expressed in terms of a copula $C$ and the marginal distristributions $(F_1, \\ldots, F_d)$. Modeling them seperately\n\n* __Easy Def:__ A Copula is a function that couples the joint distribution function to its univariate marginal distribution\n\n* Dependence or correlation coefficient dependent on marginal distributions. This one to one mapping of correlation and dependece only works in case of elliptical joint distribution\n* For copulas, we use Kendall's Tau - non-linear concordance measure\n\n# Kendall's Tau\n* Let $(X_1, Y_1)$ and $(X_2, Y_2)$ be i.i.d random vectors, each with joint distribution function $H$\n\n* Tau is then defined as the probability of concordance minus the probability of discordance\n\\vspace{-1.5cm}\n  \\begin{align}\n\\tau = \\tau_{X,Y} = P((X_1 - X_2)(Y_1 - Y_2) > 0) - P((X_1 - X_2) - (Y_1 - Y_2) < 0)\n\\end{align}\n\\vspace{-1.5cm}\n* Tau is the difference between the probability that the observed data are in the same order versus the probability that the observed data are no in the same order\n\n\\section{Copulas}\n# Meeting the generator\nThe Gaussian copula $C_p^{Ga}$ is a distribution over the unit cube $[0,1]^{d}$. This represents a linear correlation matrix $\\rho$. $C_p^{Ga}$ is defined as the distribution function of a random vector $(\\psi(X_1),\\ldots, \\psi(X_d))$, where $\\psi$ is the univariate standard normal distribution function where $X \\sim, N_d(0,\\rho)$\n\\vspace{-2cm}\n\\begin{align}\nC_p^{Ga}=\\Phi _{R}\\left(\\Phi ^{-1}(u_{1}),\\dots ,\\Phi ^{-1}(u_{d})\\right)\n\\end{align}\n\\vspace{-1.5cm}\nwhere $\\Phi^{-1}$ is the inverse cumulative distribution function of a standard normal and $\\Phi_{R}$ is the joint cumulative distribution\n\n# Student T Copula\n\nThe student's t-copula $C_{\\upsilon,\\rho}^t$ of $d$-dimension can be characterised by parameter $\\upsilon\\geq0$ degrees of freedom and linear correlation matrix $\\rho$. The random vector $X$ has a $t^d(0,\\rho\\upsilon)$ distribution with univariate function\n\\vspace{-1.5cm}\n\\begin{align}\nC_{\\upsilon,\\rho}^t &= \\mathcal{P}(t_\\upsilon(X_1)\\leq(u_1), \\ldots, t_\\upsilon(X_d)\\leq u_d)\\\\\n                    &=t_{\\upsilon,\\rho}^d(t_{\\upsilon}^{-1}(u_1),\\ldots, t_\\upsilon^{-1}(u_d))\n\\end{align}\n\n# Archimedean Copulas\n* Most common Archimedean copulas admit an explicit formula (Guassian dont)\n    * Archimedean copulas are popular because they allow modeling dependence high dimensions\n    * Does this with only one only one parameter, governing the strength of dependence.\n\n# Illustration\n\n![Some families](img/copulas.jpg \"Basic Families\")\n\nSee @joe2014dependence\n\n# Vine-Copulas\n* A vine is a graphical tool for labeling constraints in high-dimensional probability distributions\n* Regular Vines from part of what is know as pair copula construction\n* Trees are constructed between copulas based on what is know as maximum spanning degree (Or concordance measure)\n\nUnder suitable differentiability conditions, any multivariate density $F_{1\\ldots n}$ on $n$ variables may be represented in closed form as a product of univariate densities and (conditional) copula densities on any R-vine $V$\n\n# Vine copulas kurowicka2006\nThe R-vine copula density is uniquely identified according to Theorom 4.2 of @kurowicka2006:\n\\vspace{-1.5cm}\n\\begin{align}\n  c(F_1(x_1),\\cdots, F_d(x_d)) = \\prod_{i=1}^{d-1}\\prod_{e\\in E_i}c_{j(e),k(e)|D(e)}\\left(F(x_{j(e)}|\\mathbf{x}_{D(e)})\\right)\n  \\label{r_vine_eq}\n\\end{align}\n\n* Introduction to [VineCopula](https://cran.r-project.org/web/packages/VineCopula/index.html)\n* Website for the research [here](http://www.statistics.ma.tum.de/en/research/vine-copula-models/)\n\n# Introduction of Copula-MGARCH model\n\n\n\n<!-- If there are references: -->\n#References\n\\scriptsize\n\n",
    "created" : 1475770706910.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1436661149",
    "id" : "26613361",
    "lastKnownWriteTime" : 1475789420,
    "last_content_update" : 1475789420144,
    "path" : "C:/Users/Hanjo/Dropbox/Idees/Fin Metrics Klas/Class_20161007/Copulas.Rmd",
    "project_path" : "Copulas.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}